Claude 기반 Unity MCP 바이브 3D 모델링 툴 설치·구성 지시서 (TXT)
======================================================
목표
----
“처음 시작하는 사람”이 이 툴만 설치하면,
1) Unity에 MCP 설정이 완료되고 (연결 대기 상태)
2) 본인 PC에 MCP 서버(로컬 에이전트)가 구성되어
3) 웹 UI에서 자연어로 작업 지시 → MCP를 통해 Unity 프로젝트가 자동 수행되도록
개발/운영 환경을 만드는 것이 목적이다.

※ 용어
- Claude: 자연어 명령을 생성/해석하는 LLM(클라이언트)
- MCP(Model Context Protocol): LLM ↔ 툴(로컬/원격) 연결 표준
- MCP Server(로컬): Unity를 제어하는 “로컬 에이전트/브릿지” 프로세스
- Unity Editor: 실제 3D 프로젝트를 열고 작업을 수행하는 편집기
- Web UI(포털): 사용자가 자연어로 명령하고 결과/로그를 보는 웹 화면

------------------------------------------------------
A. 전체 구조(한눈에 보기)
------------------------------------------------------
[사용자 브라우저(Web UI)]
        |
        | (HTTPS/WS)
        v
[Web App/Orchestrator]  --- (LLM API) ---> [Claude]
        |
        | (MCP Client over stdio/websocket)
        v
[Local MCP Server on PC]  ---> (Unity Automation/Editor API) ---> [Unity Editor Project]

핵심 포인트
- Unity는 사용자 PC에서 실행된다. (모델/에셋/라이선스/그래픽)
- Web UI는 “명령/작업관리/로그/에셋 업로드”를 담당한다.
- MCP Server는 “Unity 자동화 수행자”로서, 로컬에서 Unity를 열고 파일을 만들고, 오브젝트를 배치하고,
  씬/프리팹/머티리얼 등을 생성한다.

------------------------------------------------------
B. 준비물(최소 요구)
------------------------------------------------------
1) OS: Windows 10/11 또는 macOS
2) Unity Hub + Unity Editor (권장: LTS 버전 2022 LTS 또는 2023 LTS 중 1개 고정)
3) Node.js LTS (또는 Python 3.11+) : MCP Server 구현 언어에 따라 선택
4) Git (옵션이지만 권장)
5) 본 툴(웹 UI + MCP Server + Unity 플러그인/패키지)

권장 사양
- RAM 16GB 이상(권장 32GB)
- GPU: 중급 이상(에디터 뷰포트 성능)
- 디스크: 프로젝트/에셋 포함 20~50GB 여유

------------------------------------------------------
C. 폴더/파일 구조(표준)
------------------------------------------------------
아래는 “처음 설치 후 유지보수까지 쉬운” 표준 구조다.

C:\ (또는 ~/)
└─ Vibe3D/
   ├─ web/                        # Web UI(포털) 소스
   │   ├─ frontend/               # React/Vite 등
   │   ├─ backend/                # API 서버(Express/FastAPI 등)
   │   ├─ .env.example
   │   └─ README.md
   ├─ mcp-server/                 # 로컬 MCP 서버(핵심)
   │   ├─ src/
   │   ├─ tools/                  # MCP tool 정의(유니티 명령들)
   │   ├─ config/
   │   │   ├─ mcp.config.json     # MCP 서버 설정(포트, 보안, 경로)
   │   │   └─ unity.paths.json    # Unity 경로/프로젝트 기본값
   │   ├─ logs/
   │   ├─ .env.example
   │   └─ README.md
   ├─ unity/
   │   ├─ Projects/               # 생성/관리되는 Unity 프로젝트들
   │   │   ├─ SampleFactoryTwin/  # 예시
   │   │   └─ ...                 # 사용자 프로젝트
   │   └─ Packages/               # Unity에 설치할 커스텀 패키지(플러그인)
   │       └─ com.vibe3d.mcp/      # Unity ↔ MCP 브릿지 패키지
   ├─ assets/
   │   ├─ import/                 # 업로드/가져올 소스(OBJ/FBX/GLB/PNG 등)
   │   ├─ library/                # 템플릿/프리셋(재질, 프리팹, 텍스처)
   │   └─ generated/              # 생성 산출물(썸네일, glTF export 등)
   ├─ docs/
   │   ├─ prompts/                # 표준 프롬프트/명령 예시
   │   ├─ schemas/                # JSON schema (명령/프로젝트 메타)
   │   └─ troubleshooting.md
   └─ scripts/
      ├─ install_windows.ps1
      ├─ install_macos.sh
      ├─ start_all_windows.ps1
      └─ start_all_macos.sh

------------------------------------------------------
D. 설치 1단계: Unity 설치/기본 설정
------------------------------------------------------
1) Unity Hub 설치
2) Unity Editor 설치(LTS 권장)
   - 모듈: Windows Build Support / Mac Build Support (필요한 것만)
3) Unity Hub에서 “새 프로젝트”를 1개 생성해 실행 확인
   - 경로 예시: Vibe3D/unity/Projects/SampleFactoryTwin

체크
- Unity Editor가 정상 실행되고, 빈 씬에서 오브젝트 생성이 가능한지 확인

------------------------------------------------------
E. 설치 2단계: MCP Server(로컬) 설치
------------------------------------------------------
선택 A: Node.js 기반(권장, 배포 쉬움)
1) Node.js LTS 설치
2) Vibe3D/mcp-server 로 이동
3) 의존성 설치
   - npm install
4) 설정 파일 생성
   - config/mcp.config.json
   - config/unity.paths.json
5) 환경변수(.env) 생성
   - .env.example을 복사하여 .env로 저장

선택 B: Python 기반(가능)
1) Python 3.11+ 설치
2) venv 생성 및 requirements 설치
3) 동일하게 config/.env 구성

(중요) unity.paths.json 예시 항목(개념)
- unity_editor_path: Unity 실행 파일 경로
- default_project_path: 기본 Unity 프로젝트 경로
- unity_hub_path(옵션)
- headless_mode: true/false (배치 작업용)

------------------------------------------------------
F. 설치 3단계: Unity MCP 브릿지 패키지 설치
------------------------------------------------------
목표
- Unity Editor 내부에서 “외부 명령(MCP)”을 받아 실행할 수 있게 한다.

방법(권장: UPM 로컬 패키지)
1) Unity 프로젝트 열기: SampleFactoryTwin
2) Package Manager 열기
3) Add package from disk...
4) 경로 선택: Vibe3D/unity/Packages/com.vibe3d.mcp/package.json

설치 후 Unity에 다음이 생겨야 함
- 메뉴: Tools > Vibe3D > MCP Settings
- 콘솔 로그: “Vibe3D MCP Bridge Loaded”

Unity 측 설정 항목
- MCP Server URL (기본: http://127.0.0.1:PORT)
- Auth Token(있다면)
- Auto-connect on Editor Start (권장: On Editor Start)

체크
- Unity가 실행될 때 MCP Server에 연결 시도 로그가 보이는지 확인

------------------------------------------------------
G. 설치 4단계: Web UI(포털) 설치
------------------------------------------------------
목표
- 사용자는 브라우저에서 자연어로 “3D 작업 지시”를 한다.
- 시스템은 작업 큐/로그/에셋 업로드/결과 미리보기를 제공한다.

1) Vibe3D/web/backend 설치 및 실행
   - npm install
   - npm run dev (또는 start)
2) Vibe3D/web/frontend 설치 및 실행
   - npm install
   - npm run dev
3) 백엔드 .env 설정
   - LLM API 키(Claude 사용 시)
   - MCP 연결 방식(로컬 사용자 PC로 라우팅하는 방식 선택)

권장 실행 포트 예시
- backend: 8080
- frontend: 5173
- mcp-server: 7337

체크
- 브라우저에서 Web UI 접속이 되는지 확인
- “MCP 연결 상태: Online/Offline” 표시가 정상인지 확인

------------------------------------------------------
H. “원클릭 시작” (사용자 입장: 설치 후 매번 실행)
------------------------------------------------------
Windows (PowerShell)
1) scripts/start_all_windows.ps1 실행
   - mcp-server 실행
   - web backend 실행
   - web frontend 실행
   - (옵션) Unity Editor 자동 실행 + 프로젝트 열기

macOS (Terminal)
1) scripts/start_all_macos.sh 실행
   - 동일 구성

사용자 완료 기준(= 사용 대기 상태)
- Web UI에서 “MCP Connected” 상태가 초록색
- Unity Editor가 열려 있고, 콘솔에 “MCP Ready” 로그
- “자연어 명령 1개”를 실행했을 때 씬에 오브젝트가 실제 생성됨

------------------------------------------------------
I. 자연어 명령 → Unity 작업으로 변환되는 “명령 스키마”
------------------------------------------------------
권장 전략
- LLM이 곧바로 Unity 코드를 쓰게 하지 말고,
  1) 자연어 → 구조화된 JSON “작업계획(Plan)”으로 변환
  2) Plan을 검증(Schema validation)
  3) 검증된 Plan만 MCP Tool 호출
이렇게 3단계로 안전하게 수행한다.

Plan(JSON) 예시(개념)
{
  "project": "SampleFactoryTwin",
  "scene": "Main",
  "actions": [
    {"type":"create_primitive","shape":"Cube","name":"Table","position":[0,0,0],"scale":[2,0.2,1]},
    {"type":"create_light","lightType":"Directional","rotation":[50,-30,0]},
    {"type":"apply_material","target":"Table","materialPreset":"Metal_Gray"}
  ]
}

Schema 파일 위치
- Vibe3D/docs/schemas/unity_plan.schema.json

------------------------------------------------------
J. MCP Tools(유니티 자동화 기능) 정의(최소 필수)
------------------------------------------------------
mcp-server/tools/ 아래에 다음 Tool을 제공한다.

1) project.open
- 입력: project_path
- 기능: Unity 프로젝트 열기(또는 이미 열려있으면 focus)

2) scene.open
- 입력: scene_name
- 기능: 씬 로드

3) scene.create_object
- 입력: type(primitive/prefab), name, transform, parent
- 기능: 오브젝트 생성

4) asset.import
- 입력: file_path, target_folder
- 기능: FBX/OBJ/GLB/PNG 등 임포트

5) material.apply
- 입력: target_object, material_preset
- 기능: 재질 적용

6) prefab.save
- 입력: object_name, save_path
- 기능: 프리팹 저장

7) export.gltf (옵션)
- 입력: scene/object, output_path, lod
- 기능: WebGL/포털용 glTF export

8) snapshot.thumbnail
- 입력: scene/object, output_path
- 기능: 썸네일 생성

9) status.ping
- 입력: none
- 기능: 연결상태/Unity 실행상태 반환

------------------------------------------------------
K. “처음 시작하는 사람” 사용 매뉴얼(초간단)
------------------------------------------------------
1) scripts/start_all 실행
2) Unity 자동 실행(또는 직접 실행) → SampleFactoryTwin 프로젝트 열기
3) Web UI 접속 → “새 작업” 버튼 클릭
4) 자연어로 지시(예시)
   - “10m x 10m 바닥을 만들고, 가운데에 탱크 1개를 놓아줘. 탱크는 스테인리스 재질로.”
   - “왼쪽 벽에 문을 만들고, 천장에 조명을 4개 균등 배치해줘.”
5) 실행 결과가 Unity 씬에 반영되는지 확인
6) “Export glTF”로 포털 미리보기용 산출물 생성

------------------------------------------------------
L. 보안/안전(중요)
------------------------------------------------------
- MCP Server는 기본적으로 localhost(127.0.0.1) 바인딩 권장
- 외부 접속 허용 시 반드시:
  - 인증 토큰
  - IP 화이트리스트
  - TLS(가능하면)
- Web UI에서 실행되는 명령은:
  - Plan(JSON) 스키마 검증 필수
  - 금지 액션(파일 삭제/임의 실행/외부 네트워크 호출 등) 차단
- 로그/감사:
  - 어떤 사용자가 어떤 명령을 언제 실행했는지 저장(감사로그)

------------------------------------------------------
M. 트러블슈팅(자주 발생)
------------------------------------------------------
1) Web UI는 되는데 MCP Connected가 안 뜸
- mcp-server가 실행 중인지 확인
- 포트 충돌 여부 확인
- unity.paths.json의 unity_editor_path 경로 확인

2) MCP 연결은 되는데 Unity 작업이 안 됨
- Unity Console에서 에러 확인
- com.vibe3d.mcp 패키지 설치 여부 확인
- Unity에서 “Auto-connect on Editor Start” 켜짐 확인

3) Unity가 headless로 열리다 실패
- 라이선스/권한 문제 가능(특히 Windows)
- GUI 모드로 먼저 실행 확인 후 headless 적용

4) 임포트가 느리거나 실패
- Assets/import 경로 권한 확인
- 파일 포맷(FBX/OBJ/GLB) 버전 호환 확인

------------------------------------------------------
N. 개발팀 체크리스트(완료 기준)
------------------------------------------------------
[설치/대기]
- 새 PC에서 30분 내 설치 완료 가능
- start_all 스크립트로 1분 내 “사용 대기 상태” 진입

[기능]
- 자연어 명령 5종 템플릿(바닥/조명/프리미티브/재질/프리팹) 성공률 90% 이상
- 작업 로그/실패 원인 메시지 제공
- Export glTF + thumbnail 생성 성공

[운영]
- 명령 실행 감사로그 저장
- Plan 스키마 검증/금지명령 차단 동작

------------------------------------------------------
O. 부록: 초보자용 자연어 명령 템플릿(바로 쓰기)
------------------------------------------------------
1) “가로 20m 세로 10m 바닥을 만들고, 회색 콘크리트 재질을 적용해줘.”
2) “탱크 프리팹을 불러와서 (2,0,3)에 배치하고 이름을 Tank_A로 해줘.”
3) “Tank_A에 온도 센서 포인트 3개를 표시용 empty object로 만들어줘.”
4) “조명을 4개 만들고 천장 높이 5m에 격자로 배치해줘.”
5) “현재 씬을 glTF로 내보내고 썸네일도 생성해줘.”

(끝)
